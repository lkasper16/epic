<lccdd>

  <info name="lfhcal.xml"
        title="EPIC LFHCAL"
        author="@FriederikeBock"
        url="https://github.com/FriederikeBock"
        status="development"
        version="1.0"
  ><comment/></info>

  <define>
    <documentation>
      #### Material Thickness
    </documentation>
    <constant name="LFHCALAbsorberThickness"       value="1.52* cm"/>
    <constant name="LFHCALPolystyreneThickness"    value="0.4* cm"/>
    <constant name="LFHCALTyvekThickness"          value="0.034* cm"/>
    <constant name="LFHCALAirOffset"               value="0.046* cm"/>
    <constant name="LFHCALElectronicsThickness"    value="10.0* cm"/>
    <documentation>
      - Hcal Endcap N Layers and computed Thickness
    </documentation>

    <comment> FIXME: Need actual values once they are decided upon </comment>
    <constant name="LFHCALLayer_NSteelRepeat" value="59"/>
    <constant name="LFHCALLayer_NTungstenRepeat" value="5"/>

    <constant name="Mod_SideWallThickness"   value="1.9812* mm"/>
    <constant name="Mod_TopWallThickness"    value="0.5* mm"/>
    <constant name="Mod_FrontWallThickness"  value="14* mm"/>
    <constant name="Mod_BackWallThickness"   value="9.91* mm"/>
    <constant name="Mod_NotchDepth"          value="1.25* mm"/>
    <constant name="Mod_SepWidth"            value="0.5* mm"/>

    <constant name="EightM_xArr"                value="4" />
    <constant name="EightM_yArr"                value="2" />
    <constant name="EightM_OuterWidth"          value="20.0* cm"/>
    <constant name="EightM_OuterHeight"         value="10.0* cm"/>
    <constant name="EightM_BackInnerWidth"      value="15.0* cm"/>
    <constant name="EightM_BackInnerHeight"     value="7.5* cm"/>
    <constant name="EightM_NotchWidthAbsA"      value="23* mm"/>
    <constant name="EightM_NotchWidthAbsB"      value="10* mm"/>
    <constant name="EightM_NotchWidthAbsC"      value="6.5* mm"/>
    <constant name="EightM_NotchWidthScin"      value="29* mm"/>
    <constant name="FourM_xArr"                value="4" />
    <constant name="FourM_yArr"                value="2" />
    <constant name="FourM_OuterWidth"          value="10.0* cm"/>
    <constant name="FourM_OuterHeight"         value="10.0* cm"/>
    <constant name="FourM_BackInnerWidth"      value="7.5* cm"/>
    <constant name="FourM_BackInnerHeight"     value="7.5* cm"/>
    <constant name="FourM_NotchWidthAbsA"      value="23* mm"/>
    <constant name="FourM_NotchWidthAbsC"      value="6.5* mm"/>
    <constant name="FourM_NotchWidthScin"      value="29* mm"/>
  </define>

  <!-- Define detector -->
  <detectors>
    <documentation>
      ### Forward (Positive Z) Endcap Hadronic Calorimeter

      This is the ECCE LFHCAL design without individual tower placements and electronics
      The original design was 60 layers of Steel/Sc and 10 layers of W/Sc, both 1.6 cm/0.4 cm
      This is too long, so 5 layers of tungsten were removed as a placeholder until the final design is chosen

      The HCal forward insert shape is cut out from this detector

      Currently don't have an implementation of electronics, so just leave that area (final 10 cm) empty
      So then, actual detector area is "LFHCAL_length - LFHCALElectronicsThickness" long
    </documentation>
    <detector
      id="LFHCAL_ID"
      name="LFHCAL"
      type="epic_LFHCAL"
      readout="LFHCALHits"
      vis="InvisibleWithDaughters"
      calorimeterType="HAD_ENDCAP"
      renderComponents="0">
      
      <position x="0" y="0" z="LFHCAL_zmin"/>
      <dimensions
        z="LFHCAL_length"
        rmin="20*cm"
        rmax="LFHCAL_rmax"/>
      <eightmodule name="8MModule" vis= "LFHCAL8MModVis" repeat="0" >
        <dimensions
        width="EightM_OuterWidth"
        height="EightM_OuterHeight"
        widthBackInner="EightM_BackInnerWidth"
        heightBackInner="EightM_BackInnerHeight"
        widthSideWall="Mod_SideWallThickness"
        widthTopWall="Mod_TopWallThickness"
        thicknessFrontWall="Mod_FrontWallThickness"
        thicknessBackWall="Mod_BackWallThickness"
        arrayX="EightM_xArr"
        arrayY="EightM_yArr" 
        notchWidthAbsA="EightM_NotchWidthAbsA"
        notchWidthAbsB="EightM_NotchWidthAbsB"
        notchWidthAbsC="EightM_NotchWidthAbsC"
        notchWidthScin="EightM_NotchWidthScin"
        notchDepth="Mod_NotchDepth"    
        sepDepth="Mod_SepWidth"
        />
        <position x="50*cm" y="50*cm" z="LFHCAL_length - LFHCALElectronicsThickness" />
      </eightmodule>
      <fourmodule name="4MModule" vis= "LFHCAL4MModVis" repeat="2">
        <dimensions
        width="FourM_OuterWidth"
        height="FourM_OuterHeight"
        widthBackInner="FourM_BackInnerWidth"
        heightBackInner="FourM_BackInnerHeight"
        widthSideWall="Mod_SideWallThickness"
        widthTopWall="Mod_TopWallThickness"
        thicknessFrontWall="Mod_FrontWallThickness"
        thicknessBackWall="Mod_BackWallThickness"
        arrayX="FourM_xArr"
        arrayY="FourM_yArr" 
        notchWidthAbsA="FourM_NotchWidthAbsA"
        notchWidthAbsC="FourM_NotchWidthAbsC"
        notchWidthScin="FourM_NotchWidthScin"
        notchDepth="Mod_NotchDepth"    
        sepDepth="Mod_SepWidth"
        />
        <position x="50*cm" y="60*cm" z="LFHCAL_length - LFHCALElectronicsThickness" />
      </fourmodule>

      
      <layer repeat="1" vis="InvisibleWithDaughters" >
        <slice material="Tyvek" thickness="LFHCALTyvekThickness" vis="LFHCALLayerTyvekVis"
               type="2" offset="LFHCALAirOffset"/>
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive=" yes"   limits="cal_limits" type="3"/>
      </layer>
      <layer repeat="LFHCALLayer_NSteelRepeat" vis="InvisibleWithDaughters" >
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis" type="1"/>
        <slice material="Tyvek" thickness="LFHCALTyvekThickness" vis="LFHCALLayerTyvekVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive=" yes"   limits="cal_limits" type="3"/>
      </layer>
      <layer repeat="LFHCALLayer_NTungstenRepeat" vis="InvisibleWithDaughters" >
        <slice material="Tungsten" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerTungstenVis" type="1"/>
        <slice material="Tyvek" thickness="LFHCALTyvekThickness" vis="LFHCALLayerTyvekVis" type="2" offset="LFHCALAirOffset"/>
        <slice material="Polystyrene" thickness="LFHCALPolystyreneThickness" vis="LFHCALLayerScintVis" sensitive=" yes" limits="cal_limits" type="3"/>
      </layer>
      <layer repeat="1" vis="InvisibleWithDaughters" >
        <slice material="Steel235" thickness="LFHCALAbsorberThickness" vis="LFHCALLayerSteelVis"  type="1"/>
      </layer>
      

      <documentation>
        ### for testing of a single module
        <eightmodulepositions name="xpos" unit="cm" values="15"/>
        <eightmodulepositions name="ypos" unit="cm" values="15"/>
        <eightmodulepositions name="zpos" unit="cm" values="0"/>
        <fourmodulepositions name="xpos" unit="cm" values="-25"/>
        <fourmodulepositions name="ypos" unit="cm" values="-25"/>
        <fourmodulepositions name="zpos" unit="cm" values="0"/>
      </documentation>

      <documentation> 
      ### smaller area LFHCAL R =100cm
      </documentation>
      <eightmodulepositions name="xpos" unit="cm" values="30 -30 50 -50 80 20 -20 -80 90 -90 60 -60 70 10 -70 0 40 -40 90 -90 80 -80 90 -90 90 50 30 -30 -50 -90 70 -70 60 -60 80 20 -20 -80 10 40 0 -40 80 -80 70 -70 50 -50 80 60 -60 -80 30 -30 80 -80 70 -70 20 -20 40 -40 10 60 0 -60 70 50 -50 -70 70 30 -30 -70 70 -70 60 -60 40 20 -20 -40 50 -50 10 60 0 -60 30 -30 60 -60 50 -50 60 40 -40 -60 20 -20 50 10 -50 0 30 -30 40 -40 50 -50 50 -50 20 -20 40 -40 30 10 -30 0 40 -40 40 20 -20 -40 30 -30 10 0 30 -30 20 -20 30 -30 0 10"/>
      <eightmodulepositions name="ypos" unit="cm" values="95 95 -85 -85 -55 -95 -95 -55 35 35 -75 -75 -65 95 -65 -95 85 85 -25 -25 45 45 15 15 -5 75 -85 -85 75 -5 55 55 65 65 -35 85 85 -35 -85 -75 85 -75 25 25 -45 -45 -65 -65 -15 -55 -55 -15 75 75 5 5 35 35 -75 -75 65 65 75 45 -75 45 -25 55 55 -25 15 -65 -65 15 -5 -5 -35 -35 -55 65 65 -55 -45 -45 -65 25 65 25 55 55 -15 -15 35 35 5 45 45 5 -55 -55 -25 55 -25 -55 -45 -45 -35 -35 15 15 -5 -5 45 45 25 25 35 -45 35 45 -15 -15 5 -35 -35 5 -25 -25 35 -35 15 15 25 25 -5 -5 25 -25"/>
      <eightmodulepositions name="zpos" unit="cm" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"/>
      <documentation>
      <fourmodulepositions name="xpos" unit="cm" values="-10 0 -10 0 -10 0 -10 0 -10 0 -10 0 -10 0 30 0 30 -10 -20 -20"/>
      <fourmodulepositions name="ypos" unit="cm" values="95 95 -85 -85 75 75 -65 -65 55 55 -45 -45 35 35 -15 -25 5 -25 -15 5"/>
      <fourmodulepositions name="zpos" unit="cm" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"/>
      </documentation>
    </detector>
    
  </detectors>

  <!--  Definition of the readout segmentation/definition  -->
  <readouts>
    <readout name="LFHCALHits">
      <segmentation type="CartesianGridXY" grid_size_x="50* mm" grid_size_y="50* mm"/>
      <id>system:8,module:12,tower:3,part:1,layer:8,x:32:-16,y:-16</id>
    </readout>
  </readouts>

</lccdd>
